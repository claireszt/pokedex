!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((t="undefined"!=typeof globalThis?globalThis:t||self).t={})}(this,(function(t){"use strict";class s{constructor(t,s,e,i=t<<16|s<<8|e){this.i=1,this.h=-1,this.o=-1,this.u=-1,this.l=-1,this.M=t,this.g=s,this.$=e,this.m=i}static distance(t,s){return(Math.abs(s.M-t.M)+Math.abs(s.g-t.g)+Math.abs(s.$-t.$))/765}clone(){const t=new s(this.M,this.g,this.$,this.m);return t.i=this.i,t}p(){const t=this.M/255,s=this.g/255,e=this.$/255,i=Math.max(t,s,e),n=Math.min(t,s,e);if(this.u=(i+n)/2,i===n)this.o=0,this.h=0,this.l=0;else{const r=i-n;switch(this.h=this.u>.5?r/(2-i-n):r/(i+n),this.l=this.h*(2*(.5-Math.abs(.5-this.u))),i){case t:this.o=((s-e)/r+(s<e?6:0))/6;break;case s:this.o=((e-t)/r+2)/6;break;case e:this.o=((t-s)/r+4)/6}}}get v(){return-1===this.o&&this.p(),this.o}get C(){return-1===this.h&&this.p(),this.h}get D(){return-1===this.u&&this.p(),this.u}get j(){return-1===this.l&&this.p(),this.l}}const e=(t,s)=>Math.abs(t-s);class i{constructor(){this._=[],this.O=null}L(t){this._.push(t),this.O=null}N(t,s,i,n){for(let o=0;o<this._.length;o++){const a=this._[o];if(!(r=a.v,h=t.v,Math.min(e(r,h),e((r+.5)%1,(h+.5)%1))<s&&e(a.C,t.C)<i&&e(a.D,t.D)<n))return!1}var r,h;return!0}get I(){if(!this.O){const{r:t,P:e,b:i}=this._.reduce(((t,s)=>(t.r+=s.M,t.P+=s.g,t.b+=s.$,t)),{r:0,P:0,b:0}),n=this._.reduce(((t,s)=>t+s.i),0);this.O=new s(Math.round(t/this._.length),Math.round(e/this._.length),Math.round(i/this._.length)),this.O.i=n}return this.O}}class n{constructor(t,s,e){this.S=[],this.v=t,this.C=s,this.D=e}L(t){const s=this.S.find((s=>s.N(t,this.v,this.C,this.D)));if(s)s.L(t);else{const s=new i;s.L(t),this.S.push(s)}}k(){return this.S.map((t=>t.I))}}var r=({pixels:t=64e3,distance:s=.22,colorValidator:e=((t,s,e,i)=>(null!=i?i:255)>250),hueDistance:i=.08333333333333333,saturationDistance:n=.2,lightnessDistance:r=.2,crossOrigin:h=null}={})=>{if("production"!==process.env.NODE_ENV){const o=(t,s,e=0,i=Number.MAX_VALUE)=>{if(Number(s)!==s)throw new Error(`${t} is not a valid number (${s})`);return s<e&&console.warn(`${t} can not be less than ${e} (it's ${s})`),s>i&&console.warn(`${t} can not be more than ${i} (it's ${s})`),Math.min(Math.max(s,e),i)},a=(t,s)=>{if(!s||"[object Function]"!=={}.toString.call(s))throw new Error(`${t} is not a function (${s})`);return s};return[((t,s,e=0,i=Number.MAX_SAFE_INTEGER)=>{if(!Number.isInteger(s))throw new Error(`${t} is not a valid number (${s})`);return s<e&&console.warn(`${t} can not be less than ${e} (it's ${s})`),s>i&&console.warn(`${t} can not be more than ${i} (it's ${s})`),Math.min(Math.max(s,e),i)})("pixels",t||0,1),o("distance",s,0,1),a("colorValidator",e),o("hueDistance",i,0,1),o("saturationDistance",n,0,1),o("lightnessDistance",r,0,1),h]}return[Math.max(t,1),Math.min(Math.max(s,0),1),e,Math.min(Math.max(i,0),1),Math.min(Math.max(n,0),1),Math.min(Math.max(r,0),1),h]};class h{constructor(){this.i=0,this.G={}}L(t,e,i,n){return this.i++,this.G[t]?this.G[t].i++:this.G[t]=new s(e,i,n,t),this.G[t]}T(){return Object.keys(this.G).map((t=>this.G[t]))}V(){const t=this.T().reduce(((t,s)=>t.i>=s.i?t:s)).clone();return t.i=this.i,t}}class o{constructor(){this.i=0,this.G={}}T(){return Object.keys(this.G).map((t=>this.G[t]))}L(t,s,e){const i=t<<16|s<<8|e,n=(t>>4&15)<<8|(s>>4&15)<<4|e>>4&15;return this.i++,this.F(n).L(i,t,s,e)}F(t){return this.G[t]||(this.G[t]=new h),this.G[t]}H(t){const e=this.T().map((t=>t.V()));e.sort(((t,s)=>s.i-t.i));const i=[];for(;e.length;){const n=e.shift();e.filter((e=>s.distance(n,e)<t)).forEach((t=>{n.i+=t.i;const s=e.findIndex((s=>s===t));e.splice(s,1)})),i.push(n)}return i}}var a=({data:t,width:s,height:e},i,n,r)=>{const h=new o,a=s&&e&&Math.floor(s*e/i)||1;let c=0;for(let o=0;o<t.length;o+=4*a){const s=t[o],e=t[o+1],i=t[o+2];r(s,e,i,t[o+3])?h.L(s,e,i):c++}return{_:h.H(n),count:h.i+c}};const c=(t,s,e,i,r)=>{const h=((t,s,e,i,r)=>{const h=new n(e,i,r);t.forEach((t=>h.L(t)));const o=h.k();return o.sort(((t,e)=>(e.j+.1)*(.9-e.i/s)-(t.j+.1)*(.9-t.i/s))),o})(t,s,e,i,r);return h.map((t=>((t,s)=>({hex:`#${"0".repeat(6-t.m.toString(16).length)}${t.m.toString(16)}`,red:t.M,green:t.g,blue:t.$,area:t.i/s,hue:t.v,saturation:t.C,lightness:t.D,intensity:t.j}))(t,s)))},u=(t,s={})=>{const[e,i,n,h,o,u]=r(s),{_:l,count:d}=a(t,e,i,n);return c(l,d,h,o,u)},l=(t,s={})=>{const[e,i,n,h,o,u,l]=r(s);return t.crossOrigin=l,new Promise((s=>{const r=t=>{const r=((t,s)=>{const e=t.width*t.height,i=e<s?t.width:Math.round(t.width*Math.sqrt(s/e)),n=e<s?t.height:Math.round(t.height*Math.sqrt(s/e)),r=document.createElement("canvas");r.width=i,r.height=n;const h=r.getContext("2d");return h.drawImage(t,0,0,t.width,t.height,0,0,i,n),h.getImageData(0,0,i,n)})(t,e),{_:l,count:d}=a(r,e,i,n);s(c(l,d,h,o,u))};if(t.complete)r(t);else{const s=()=>{t.removeEventListener("load",s),r(t)};t.addEventListener("load",s)}}))},d=(t,s={})=>{const e=new Image;return e.src=t,l(e,s)},f=(t,s)=>{if(t instanceof Image)return l(t,s);if(t instanceof ImageData||t instanceof Object&&t.data)return new Promise((e=>{e(u(t,s))}));if("string"==typeof t)return d(t,s);throw new Error("Can not analyse picture")};t.default=f,t.extractColors=f,t.extractColorsFromImage=l,t.extractColorsFromImageData=u,t.extractColorsFromSrc=d,Object.defineProperties(t,{q:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
//# sourceMappingURL=extract-colors.browser.umd.js.map
